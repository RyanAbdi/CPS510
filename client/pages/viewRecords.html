<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toronto KittyCab | View Records</title>
    <link rel="stylesheet" type="text/css" href="../css/viewRecords.css">
    <link rel="stylesheet" type="text/css" href="../css/styles.css">
    <script src="../components/navbar.js" type="text/javascript" defer></script>
    <script src="../js/viewRecords.js" type="text/javascript" defer></script>
    <!--<link rel="icon" href="./media/" type="image/*"> -->

</head>

<body>
    <navbar-component></navbar-component>

    <div class="content">
        <div class="view-records-container" id="view-records">
            <a href="viewTables.html" class="go-back-btn">&larr; Go Back</a>

            <h1>View Records</h1>

            <p>Table: <span id="table-name"></span></p>

            <div id="column-names"></div>
            <div class="records-container" id="records-container"></div>

        </div>
    </div>

    <script src="../js/selectTable.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            const records = await myFunction();
            console.log(records);

            const recordsContainer = document.getElementById('records-container');
            const columnNamesContainer = document.getElementById('column-names');

            recordsContainer.innerHTML = '';
            columnNamesContainer.innerHTML = '';

            let count = 0;

            records.forEach(record => {
                const recordDiv = document.createElement('div');
                recordDiv.classList.add('record-entry', 'record-row');

                Object.keys(record).forEach((key, index, keys) => {
                    if (count === 0 && key !== undefined) {
                        const keys = Object.keys(record)
                        const columnNameDiv = document.createElement('div');
                        columnNameDiv.classList.add('column-input');

                        keys.forEach(k => {
                            const strongElement = document.createElement('strong');
                            strongElement.style.width = '156px';
                            strongElement.textContent = k;
                            columnNameDiv.appendChild(strongElement);
                        });

                        columnNamesContainer.appendChild(columnNameDiv);
                        count += 1;
                    }

                    const fieldDiv = document.createElement('div');

                    fieldDiv.innerHTML = `<input type="text" value="${record[key]}" size="${17}">`;

                    if (index === keys.length - 1) {
                        const deleteButton = document.createElement('button');
                        deleteButton.textContent = 'Delete';
                        deleteButton.addEventListener('click', () => {
                            // Farah make it call delete
                            console.log(`Delete button clicked for row with ${key}: ${record[key]}`);
                        });
                        fieldDiv.appendChild(deleteButton);
                    }

                    recordDiv.appendChild(fieldDiv);

                });

                recordsContainer.appendChild(recordDiv);
            });
        });
    </script>

    <footer>
        <div class="copyright">
            &copy; Toronto KittyCab 2023
        </div>
    </footer>
</body>

</html>